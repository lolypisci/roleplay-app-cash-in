<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Teacher View - Roleplay Archive</title>
</head>
<body>

<h1>Saved Sessions</h1>

<table border="1" id="roleplays-table">
  <thead>
    <tr>
      <th>Buyer</th>
      <th>Seller</th>
      <th>Purchased Items</th>
      <th>Costs</th>
      <th>Audio</th>
      <th>Timestamp</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
function loadRoleplays() {
  fetch('/roleplays')
    .then(response => response.json())
    .then(data => {
      const tbody = document.querySelector("#roleplays-table tbody");
      tbody.innerHTML = "";

      data.forEach(r => {
        const productosHTML = r.productos.join(", ");
        const costesHTML = r.costes.map(c => "â‚¬" + c.toFixed(2)).join(", ");

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${r.comprador}</td>
          <td>${r.vendedor}</td>
          <td>${productosHTML}</td>
          <td>${costesHTML}</td>
          <td><audio controls src="${r.audio_url}"></audio></td>
          <td>${new Date(r.timestamp).toLocaleString()}</td>
        `;
        tbody.appendChild(tr);
      });
    });
}

window.onload = loadRoleplays;
</script>

</body>
</html>
